LAMP Install Notes 20161019 2016.293
Copyright Â© 2014, 2015, 2016, William N. Braswell, Jr.. All Rights Reserved. This work is Free & Open Source; you can redistribute it and/or modify it under the same terms as Perl 5.24.0.

# [[[ UNINDENT ]]]
:%s/^\ \ \ \ //g


# [[[ PERL SHINYCMS, CONFIGURE APACHE MOD_FASTCGI ]]]
# [ YOU SHOULD USE THIS UNLESS YOU HAVE NO CHOICE ]
# [ DO NOT MIX WITH APACHE MOD_PERL, BELOW ]
$ cpanm FCGI FCGI::ProcManager  # NOT ROOT IF local::lib
$ a2enmod fastcgi
$ vi /etc/apache2/sites-available/SOMEDOMAIN.COM.conf
    <VirtualHost *:80>
        ServerName SOMEDOMAIN.COM
        ServerAlias www.SOMEDOMAIN.COM
        ServerAdmin webmaster@SOMEDOMAIN.COM
    #    DocumentRoot /srv/www/SOMEDOMAIN.COM/public_html/  # mod_fastcgi overrides below
        <Directory />  # required for Apache v2.4 in Ubuntu v14.04.pre
            Require all granted
        </Directory>
        ErrorLog /srv/www/SOMEDOMAIN.COM/logs/error.log
        CustomLog /srv/www/SOMEDOMAIN.COM/logs/access.log combined
    # MOD_FASTCGI
        DocumentRoot    /home/SOMEBODY/public_html/SOMEDOMAIN.COM-latest/root
        <Location />
            Order allow,deny
            Allow from all
        </Location>
        # Google Webmaster Tools, Robots Testing Tool 
        Alias    /googleSOMELONGNUMBER.html    /home/SOMEBODY/public_html/SOMEDOMAIN.COM-latest/root/googleSOMELONGNUMBER.html
        # Allow Apache to serve static content.
        Alias       /static     /home/SOMEBODY/public_html/SOMEDOMAIN.COM-latest/root/static
        <Location /static>  # UNNECESSARY???
            SetHandler          default-handler
        </Location>
        # Display friendly error page if the FastCGI process is not running.
        ErrorDocument   502     /home/SOMEBODY/public_html/SOMEDOMAIN.COM-latest/root/offline.html
        # Connect to the external server.
        FastCgiExternalServer   /tmp/SOMEDOMAIN.COM.fcgi -socket /tmp/SOMEDOMAIN.COM.socket -idle-timeout 900
        Alias           /       /tmp/SOMEDOMAIN.COM.fcgi/
    </VirtualHost>
$ cd /home/SOMEBODY/public_html/SOMEDOMAIN-latest
$ vi modified/offline.html
    <b>ERROR 502:</b> FastCGI Process Not Running, Please Inform Site Administrator <a href="mailto:SOMEBODY@SUBDOMAIN.SOMEDOMAIN.COM">ADMIN NAME</a>
# START FASTCGI SERVER, MANUAL
$ ~/bin/fastcgi_start__SOMEDOMAIN.COM.sh  # LOCAL::LIB, RUN AS USER SOMEBODY BY USER SOMEBODY, MUST HAVE CREATED SYMLINKS IN EDIT-MYSHINYTEMPLATE-FILES SECTION ABOVE
    # OR
$ sudo -Eu SOMEBODY /home/SOMEBODY/public_html/SOMEDOMAIN-latest/bin/external-fastcgi-server  # PERLBREW, RUN AS USER SOMEBODY BY USER root
$ cat /tmp/SOMEDOMAIN.COM.pid
# START FASTCGI SERVER, AUTOMATIC
$ ln -s /home/SOMEBODY/public_html/SOMEDOMAIN-latest/modified/fastcgi_SOMEDOMAIN.COM.conf /etc/init  # UPSTART, MOST MODERN LINUX DISTROS
$ initctl reload-configuration  # OR    $ reboot
$ initctl list | grep SOMEDOMAIN
$ service fastcgi_SOMEDOMAIN.COM start
$ service fastcgi_SOMEDOMAIN.COM status
    # OR
$ ln -s /home/SOMEBODY/public_html/SOMEDOMAIN-latest/modified/fastcgi_SOMEDOMAIN.COM-init.d /etc/init.d  # SYSV-INIT, OLDER LINUX DISTROS
$ reboot


# [[[ PERL SHINYCMS, CONFIGURE APACHE MOD_PERL ]]]
# [ DO NOT USE THIS UNLESS YOU HAVE NO CHOICE ]
# [ DO NOT MIX WITH APACHE MOD_FASTCGI, ABOVE ]
$ vi /etc/apache2/sites-available/SOMEDOMAIN.COM.conf
    # DOMAIN
    <VirtualHost *:80>
        ServerName SOMEDOMAIN.COM
        ServerAlias www.SOMEDOMAIN.COM
        ServerAdmin webmaster@SOMEDOMAIN.COM
        DocumentRoot /srv/www/SOMEDOMAIN.COM/public_html/
        <Directory />  # required for Apache v2.4 in Ubuntu v14.04.pre
            Require all granted
        </Directory>
        # Google Webmaster Tools, Robots Testing Tool 
        Alias    /googleSOMELONGNUMBER.html    /home/SOMEBODY/public_html/SOMEDOMAIN.COM-latest/root/googleSOMELONGNUMBER.html
        ErrorLog /srv/www/SOMEDOMAIN.COM/logs/error.log
        CustomLog /srv/www/SOMEDOMAIN.COM/logs/access.log combined
        <Perl>
            use lib '/home/SOMEBODY/public_html/SOMEDOMAIN.COM-latest/lib';  # ShinyCMS
            use lib '/home/SOMEBODY/perl5/lib/perl5';  # local::lib
        </Perl>
    #   PerlRequire     /home/example.com/code/ShinyCMS/startup.pl  # handled by 'use lib' code above 
        PerlModule      ShinyCMS
        Alias   /static     /home/SOMEBODY/public_html/SOMEDOMAIN.COM-latest/root/static
        <Location />
            SetHandler          modperl 
            PerlResponseHandler +ShinyCMS
        </Location>
        <Location /static>  # UNNECESSARY???
            SetHandler  default-handler
        </Location>
    </VirtualHost>
        # OR
    # SUBDOMAIN
    <VirtualHost *:80>
        ServerName SUBDOMAIN.SOMEDOMAIN.COM
        ServerAdmin webmaster@SOMEDOMAIN.COM
        DocumentRoot /srv/www/SUBDOMAIN.SOMEDOMAIN.COM/public_html/
        <Directory />  # required for Apache v2.4 in Ubuntu v14.04.pre
            Require all granted
        </Directory>
        # Google Webmaster Tools, Robots Testing Tool 
        Alias    /googleSOMELONGNUMBER.html    /home/SOMEBODY/public_html/SUBDOMAIN.SOMEDOMAIN.COM-latest/root/googleSOMELONGNUMBER.html
        ErrorLog /srv/www/SUBDOMAIN.SOMEDOMAIN.COM/logs/error.log
        CustomLog /srv/www/SUBDOMAIN.SOMEDOMAIN.COM/logs/access.log combined
        <Perl>
            use lib '/home/SOMEBODY/public_html/SUBDOMAIN.SOMEDOMAIN.COM-latest/lib';  # ShinyCMS
            use lib '/home/SOMEBODY/perl5/lib/perl5';  # local::lib
        </Perl>
    #   PerlRequire     /home/SOMEBODY/public_html/SUBDOMAIN.SOMEDOMAIN.COM-latest/startup.pl  # handled by 'use lib' code above 
        PerlModule      ShinyCMS
        Alias   /static     /home/SOMEBODY/public_html/SUBDOMAIN.SOMEDOMAIN.COM-latest/root/static
        <Location />
            SetHandler          modperl 
            PerlResponseHandler +ShinyCMS
        </Location>
        <Location /static>  # UNNECESSARY???
            SetHandler  default-handler
        </Location>
    </VirtualHost>
